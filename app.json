{
  "_comment": "This file is generated. Please edit .homeycompose/app.json instead.",
  "id": "com.batrium",
  "version": "0.9.0",
  "compatibility": ">=5.0.0",
  "sdk": 3,
  "name": {
    "en": "Batrium",
    "sv": "Batrium"
  },
  "brandColor": "#00adef",
  "description": {
    "en": "Batteries Made Smarter",
    "sv": "Smartare Batterier"
  },
  "category": [
    "energy"
  ],
  "tags": {
    "en": [
      "batrium",
      "bms",
      "watchmon",
      "battery",
      "energy"
    ],
    "sv": [
      "batrium",
      "bms",
      "watchmon",
      "batteri",
      "energi"
    ]
  },
  "permissions": [],
  "images": {
    "large": "/assets/images/large.png",
    "small": "/assets/images/small.png"
  },
  "author": {
    "name": "Richard Barkestam",
    "email": "richard@barkestam.se"
  },
  "contributing": {
    "donate": {
      "paypal": {
        "username": "RBarkestam",
        "currency": "EUR"
      }
    }
  },
  "bugs": {
    "url": "https://github.com/ricott/homey-com.batrium/issues"
  },
  "source": "https://github.com/ricott/homey-com.batrium",
  "flow": {
    "triggers": [
      {
        "id": "operational_status_changed",
        "title": {
          "en": "Status changed",
          "sv": "Status ändrades"
        },
        "titleFormatted": {
          "en": "Status changed to [[status]]",
          "sv": "Status ändrades till [[status]]"
        },
        "tokens": [
          {
            "name": "status",
            "type": "string",
            "title": {
              "en": "Status",
              "sv": "Status"
            },
            "example": {
              "en": "Idle"
            }
          }
        ],
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=watchmon"
          }
        ]
      },
      {
        "id": "charge_rate_status_changed",
        "title": {
          "en": "Charge rate state changed",
          "sv": "Laddhastigheten ändrades"
        },
        "titleFormatted": {
          "en": "Charge rate state changed to [[status]]",
          "sv": "Laddhastigheten ändrades till [[status]]"
        },
        "tokens": [
          {
            "name": "status",
            "type": "string",
            "title": {
              "en": "Status",
              "sv": "Status"
            },
            "example": {
              "en": "Off"
            }
          }
        ],
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=watchmon"
          }
        ]
      },
      {
        "id": "discharge_rate_status_changed",
        "title": {
          "en": "Discharge rate state changed",
          "sv": "Urladdningshastigheten ändrades"
        },
        "titleFormatted": {
          "en": "Discharge rate state changed to [[status]]",
          "sv": "Urladdningshastigheten ändrades till [[status]]"
        },
        "tokens": [
          {
            "name": "status",
            "type": "string",
            "title": {
              "en": "Status",
              "sv": "Status"
            },
            "example": {
              "en": "Off"
            }
          }
        ],
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=watchmon"
          }
        ]
      },
      {
        "id": "cell_volt_diff_changed",
        "title": {
          "en": "Maximum cell volt difference changed",
          "sv": "Största cell volt skillnaden ändrades"
        },
        "titleFormatted": {
          "en": "Maximum cell volt difference changed to [[difference]]",
          "sv": "Största cell volt skillnaden ändrades [[difference]]"
        },
        "tokens": [
          {
            "name": "difference",
            "type": "number",
            "title": {
              "en": "Difference (mV)",
              "sv": "Skillnad (mV)"
            },
            "example": {
              "en": "80"
            }
          }
        ],
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=watchmon"
          }
        ]
      }
    ],
    "conditions": [
      {
        "id": "phaseUtilized",
        "title": {
          "en": "A phase is utilized !{{above|below}}",
          "sv": "En fas är utnyttjad !{{över|under}}"
        },
        "titleFormatted": {
          "en": "Phase [[phase]] is utilized !{{above|below}} [[utilization]]%",
          "sv": "Fas [[phase]] är utnyttjad !{{över|under}} [[utilization]]%"
        },
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=watchmon"
          },
          {
            "name": "phase",
            "type": "dropdown",
            "values": [
              {
                "id": "L1",
                "label": {
                  "en": "L1"
                }
              },
              {
                "id": "L2",
                "label": {
                  "en": "L2"
                }
              },
              {
                "id": "L3",
                "label": {
                  "en": "L3"
                }
              }
            ]
          },
          {
            "name": "utilization",
            "type": "number",
            "title": {
              "en": "Utilization (%)",
              "sv": "Utnyttjad (%)"
            }
          }
        ]
      },
      {
        "id": "anyPhaseUtilized",
        "title": {
          "en": "Any phase is utilized !{{above|below}}",
          "sv": "Någon fas är utnyttjad !{{över|under}}"
        },
        "titleFormatted": {
          "en": "Any phase is utilized !{{above|below}} [[utilization]]%",
          "sv": "Någon fas är utnyttjad !{{över|under}} [[utilization]]%"
        },
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=watchmon"
          },
          {
            "name": "utilization",
            "type": "number",
            "title": {
              "en": "Utilization (%)",
              "sv": "Utnyttjad (%)"
            }
          }
        ]
      }
    ]
  },
  "drivers": [
    {
      "name": {
        "en": "Watchmon",
        "sv": "Watchmon"
      },
      "images": {
        "large": "drivers/watchmon/assets/images/large.png",
        "small": "drivers/watchmon/assets/images/small.png"
      },
      "class": "sensor",
      "capabilities": [
        "operational_status",
        "battery_capacity",
        "measure_voltage",
        "measure_current",
        "measure_voltage.cellMin",
        "measure_voltage.cellMax",
        "measure_temperature.cellMin",
        "measure_temperature.cellMax",
        "operational_status.ChargePowerRate",
        "operational_status.DischargePowerRate",
        "meter_power.charge",
        "meter_power.discharge"
      ],
      "capabilitiesOptions": {
        "measure_voltage": {
          "title": {
            "en": "Shunt volt",
            "sv": "Shunt spänning"
          }
        },
        "measure_current": {
          "title": {
            "en": "Shunt current",
            "sv": "Shunt ström"
          }
        },
        "measure_voltage.cellMin": {
          "title": {
            "en": "Min cell volt",
            "sv": "Lägsta cellspänning"
          }
        },
        "measure_voltage.cellMax": {
          "title": {
            "en": "Max cell volt",
            "sv": "Högsta cellspänning"
          }
        },
        "measure_temperature.cellMin": {
          "title": {
            "en": "Min cell temp",
            "sv": "Lägsta celltemp."
          }
        },
        "measure_temperature.cellMax": {
          "title": {
            "en": "Max cell temp",
            "sv": "Högsta celltemp."
          }
        },
        "operational_status.ChargePowerRate": {
          "title": {
            "en": "Charge rate state",
            "sv": "Laddhastighet"
          }
        },
        "operational_status.DischargePowerRate": {
          "title": {
            "en": "Discharge rate state",
            "sv": "Urladdningshastighet"
          }
        },
        "meter_power.charge": {
          "title": {
            "en": "Cumulative charge",
            "sv": "Total laddning"
          }
        },
        "meter_power.discharge": {
          "title": {
            "en": "Cumulative discharge",
            "sv": "Total urladdning"
          }
        }
      },
      "pair": [
        {
          "id": "list_devices",
          "template": "list_devices",
          "navigation": {
            "next": "add_devices"
          }
        },
        {
          "id": "add_devices",
          "template": "add_devices"
        }
      ],
      "settings": [
        {
          "type": "group",
          "label": {
            "en": "Settings",
            "sv": "Inställningar"
          },
          "children": [
            {
              "id": "refreshInterval",
              "type": "number",
              "value": 3,
              "step": 1,
              "attr": {
                "min": 1,
                "max": 3600
              },
              "label": {
                "en": "Refresh interval",
                "sv": "Uppdateringsfrekvens"
              }
            }
          ]
        },
        {
          "type": "group",
          "label": {
            "en": "Information",
            "sv": "Information"
          },
          "children": [
            {
              "id": "hardwareVersion",
              "type": "label",
              "label": {
                "en": "Hardware version",
                "sv": "Hårdvaruversion"
              },
              "value": ""
            },
            {
              "id": "firmwareVersion",
              "type": "label",
              "label": {
                "en": "Firmware version",
                "sv": "Mjukvaruversion"
              },
              "value": ""
            },
            {
              "id": "numOfCellsActive",
              "type": "label",
              "label": {
                "en": "Numer of active cells",
                "sv": "Antal aktiva celler"
              },
              "value": ""
            }
          ]
        },
        {
          "type": "group",
          "label": {
            "en": "Debug",
            "sv": "Felsökning"
          },
          "children": [
            {
              "id": "last_error",
              "type": "textarea",
              "label": {
                "en": "Most recent API error",
                "sv": "Senaste API felmeddelandet"
              },
              "value": ""
            }
          ]
        }
      ],
      "id": "watchmon"
    }
  ],
  "capabilities": {
    "battery_capacity": {
      "type": "number",
      "title": {
        "en": "Battery SoC",
        "sv": "Batteri SoC"
      },
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "icon": "/assets/battery_capacity.svg",
      "units": {
        "en": "%",
        "sv": "%"
      }
    },
    "operational_status": {
      "type": "string",
      "title": {
        "en": "Status",
        "sv": "Status"
      },
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "icon": "/assets/operational_status.svg"
    }
  }
}